diff --git a/JSS.egg-info/SOURCES.txt b/JSS.egg-info/SOURCES.txt
index 26a5070..f15aace 100644
--- a/JSS.egg-info/SOURCES.txt
+++ b/JSS.egg-info/SOURCES.txt
@@ -18,6 +18,7 @@ JSS/multiprocessing_env.py
 JSS/random_loop.py
 JSS/train.py
 JSS/train_wandb.py
+JSS/train_wandb_impala.py
 JSS.egg-info/PKG-INFO
 JSS.egg-info/SOURCES.txt
 JSS.egg-info/dependency_links.txt
diff --git a/JSS/.ipynb_checkpoints/models-checkpoint.py b/JSS/.ipynb_checkpoints/models-checkpoint.py
index 933b659..26b023d 100644
--- a/JSS/.ipynb_checkpoints/models-checkpoint.py
+++ b/JSS/.ipynb_checkpoints/models-checkpoint.py
@@ -32,8 +32,9 @@ class FCMaskedActionsModelTF(DistributionalQTFModel, TFModelV2):
         raw_actions, _ = self.action_embed_model({
             "obs": input_dict["obs"]["real_obs"]
         })
-        inf_mask = tf.maximum(tf.math.log(action_mask), tf.float32.min)
-        return raw_actions + inf_mask, state
+        #inf_mask = tf.maximum(tf.math.log(action_mask), tf.float32.min)
+        logits = tf.where(action_mask == 1, raw_actions, -1e12)
+        return logits, state
 
     def value_function(self):
         return self.action_embed_model.value_function()
\ No newline at end of file
diff --git a/JSS/__pycache__/models.cpython-38.pyc b/JSS/__pycache__/models.cpython-38.pyc
index b92e3ad..48e3b38 100644
Binary files a/JSS/__pycache__/models.cpython-38.pyc and b/JSS/__pycache__/models.cpython-38.pyc differ
diff --git a/JSS/models.py b/JSS/models.py
index 933b659..26b023d 100644
--- a/JSS/models.py
+++ b/JSS/models.py
@@ -32,8 +32,9 @@ class FCMaskedActionsModelTF(DistributionalQTFModel, TFModelV2):
         raw_actions, _ = self.action_embed_model({
             "obs": input_dict["obs"]["real_obs"]
         })
-        inf_mask = tf.maximum(tf.math.log(action_mask), tf.float32.min)
-        return raw_actions + inf_mask, state
+        #inf_mask = tf.maximum(tf.math.log(action_mask), tf.float32.min)
+        logits = tf.where(action_mask == 1, raw_actions, -1e12)
+        return logits, state
 
     def value_function(self):
         return self.action_embed_model.value_function()
\ No newline at end of file
diff --git a/JSS/wandb/debug-internal.log b/JSS/wandb/debug-internal.log
index 94b082e..9df72c3 120000
--- a/JSS/wandb/debug-internal.log
+++ b/JSS/wandb/debug-internal.log
@@ -1 +1 @@
-run-20201130_152536-4dm99na4/logs/debug-internal.log
\ No newline at end of file
+run-20201130_154443-yld6bb8n/logs/debug-internal.log
\ No newline at end of file
diff --git a/JSS/wandb/debug.log b/JSS/wandb/debug.log
index 789d6a4..2fe3870 120000
--- a/JSS/wandb/debug.log
+++ b/JSS/wandb/debug.log
@@ -1 +1 @@
-run-20201130_152536-4dm99na4/logs/debug.log
\ No newline at end of file
+run-20201130_154443-yld6bb8n/logs/debug.log
\ No newline at end of file
diff --git a/JSS/wandb/latest-run b/JSS/wandb/latest-run
index 6159873..22e36f1 120000
--- a/JSS/wandb/latest-run
+++ b/JSS/wandb/latest-run
@@ -1 +1 @@
-run-20201130_152536-4dm99na4
\ No newline at end of file
+run-20201130_154443-yld6bb8n
\ No newline at end of file
